<div id="wrapper">
  <!-- Sidebar -->
  <div
    id="sidebar"
    class="fixed top-0 left-0 z-40 max-md:top-auto max-md:bottom-0"
  >
    <div
      id="sidebar__inner"
      class="flex flex-col justify-between md:h-screen md:p-2 p-1 transition-all duration-500 bg-white shadow dark:bg-dark2 2xl:w-72 w-64 max-md:border-t max-md:dark:border-slate-700"
    >
      <!-- Logo -->
      <div
        class="flex h-32 px-2 max-md:fixed max-md:top-0 max-md:w-full max-md:bg-white/80 max-md:left-0 max-md:px-4 max-md:h-14 max-md:shadow-sm max-md:dark:bg-slate-900/80 backdrop-blur-xl"
      >
        <a routerLink="/feeds" id="logo" class="flex items-center gap-3">
          <img
            id="logo__text"
            src="assets/mobile_logo.png"
            alt="Logo"
            class="w-full h-20 ml-1 max-sm:hidden max-md:block"
          />
        </a>
      </div>

      <!-- Navigation (Header) -->
      <nav class="flex-1 flex flex-col space-y-2">
        <!-- Home -->
        <a
          routerLink="/feeds"
          class="flex items-center p-2 hover:bg-gray-100 rounded"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="2"
            stroke="currentColor"
            class="w-6 h-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75"
            />
          </svg>
          <span class="max-sm:hidden ml-4">Home</span>
        </a>

        <!-- Messages -->
        <a
          routerLink="/messages"
          class="flex items-center p-2 hover:bg-gray-100 rounded max-md:fixed max-md:top-2 max-md:right-2"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="2"
            stroke="currentColor"
            class="w-6 h-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z"
            />
          </svg>
          <span class="max-sm:hidden ml-4">Messages</span>
        </a>

        <!-- Create -->
        <a
          routerLink="/create"
          class="flex items-center p-2 hover:bg-gray-100 rounded"
        >
          <button class="flex items-center gap-3 w-full">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-6 h-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"
              />
            </svg>
            <span class="max-sm:hidden">Create</span>
          </button>
        </a>

        <!-- About Us -->
        <a
          routerLink="/about"
          class="flex items-center p-2 hover:bg-gray-100 rounded"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="currentColor"
            viewBox="0 0 16 16"
            class="w-6 h-6"
          >
            <path
              d="M8 16.016a7.5 7.5 0 0 0 1.962-14.74A1 1 0 0 0 9 0H7a1 1 0 0 0-.962 1.276A7.5 7.5 0 0 0 8 16.016zM14.5 8.516a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"
            />
            <path d="m6.94 7.44 4.95-2.83-2.83 4.95-4.949 2.83 2.828-4.95z" />
          </svg>
          <span class="max-sm:hidden ml-4">About Us</span>
        </a>

        <!-- External Links -->
        <a
          href="https://github.com/socialnotebooks"
          target="_blank"
          class="flex items-center p-2 hover:bg-gray-100 rounded"
        >
          <i class="fab fa-github text-xl mr-2"></i>
          <span class="max-sm:hidden ml-4">Source Code</span>
        </a>
        <a
          href="https://www.linkedin.com/in/manish-pardeshi-069417133/"
          target="_blank"
          class="flex items-center p-2 hover:bg-gray-100 rounded"
        >
          <i class="fab fa-linkedin text-xl mr-2"></i>
          <span class="max-sm:hidden ml-4">Follow on LinkedIn</span>
        </a>

        <!-- Google Sign-In Button in Navbar (visible if not signed in or not verified) -->
        <div
          id="googleSignInDiv"
          class="mt-2 border-0"
          *ngIf="!signedIn || generatedUserData.isVerified !== 'true'"
        ></div>
        <!-- <ng-template #loggedIn>
          <li>
            <a href="#" (click)="logout(); toggleProfileDropdown(); $event.preventDefault()"
               class="flex items-center gap-3 rounded-md p-2 hover:bg-gray-200 dark:hover:bg-gray-700">
              <i class="fa fa-sign-out-alt text-xl mr-2"></i>
              <span>Log Out</span>
            </a>
          </li>
        </ng-template> -->
      </nav>

      <!-- Profile Section -->
      <div class="relative">
        <button
          (click)="toggleProfileDropdown()"
          class="flex items-center gap-3 p-3 cursor-pointer focus:outline-none"
        >
          <ng-container
            *ngIf="
              generatedUserData?.profilePic && !profileImgError;
              else fallbackAvatar
            "
          >
            <img
              [src]="generatedUserData?.profilePic"
              alt="Profile Picture"
              class="w-8 h-8 rounded-full"
              (error)="profileImgError = true"
            />
          </ng-container>
          <ng-template #fallbackAvatar>
            <div
              class="w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center text-xs font-medium text-gray-700"
            >
              {{
                generatedUserData?.username
                  ? generatedUserData.username.charAt(0).toUpperCase()
                  : "?"
              }}
            </div>
          </ng-template>
          <span
            class="font-semibold text-sm text-gray-900 dark:text-gray-800 max-sm:block"
          >
            My Profile
          </span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="2"
            stroke="currentColor"
            class="w-5 h-5 ml-auto transform transition-transform duration-200"
            [ngClass]="{ 'rotate-90': profileDropdownOpen }"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M9 5l7 7-7 7"
            />
          </svg>
        </button>
        <div
          *ngIf="profileDropdownOpen"
          class="absolute bottom-full mb-2 w-60 right-0 bg-white dark:bg-dark2 border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg z-50"
        >
          <div
            class="w-full h-1.5 bg-gradient-to-r from-pink-500 via-red-500 to-purple-500"
          ></div>
          <div class="p-4 text-xs font-medium flex items-center">
            <ng-container
              *ngIf="
                generatedUserData?.profilePic && !profileImgError;
                else fallbackAvatar
              "
            >
              <img
                [src]="generatedUserData?.profilePic"
                alt="Profile Picture"
                class="w-8 h-8 rounded-full"
                (error)="profileImgError = true"
              />
            </ng-container>
            <ng-template #fallbackAvatar>
              <div
                class="w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center text-xs font-medium text-gray-700"
              >
                {{
                  generatedUserData?.username
                    ? generatedUserData.username.charAt(0).toUpperCase()
                    : "?"
                }}
              </div>
            </ng-template>
            <div class="ml-2">
              <div
                class="text-base font-semibold text-gray-900 dark:text-gray-800"
              >
                {{
                  generatedUserData?.firstName || generatedUserData?.lastName
                    ? (
                        generatedUserData.firstName +
                        " " +
                        generatedUserData.lastName
                      ).trim()
                    : formatUsername(generatedUserData.username)
                }}
              </div>
              <div class="flex items-center text-gray-600 dark:text-gray-900">
                <span
                  *ngIf="generatedUserData.isVerified === 'true'"
                  class="text-blue-500"
                  title="Verified"
                >
                  {{ generatedUserData?.username }}
                  <i class="fa fa-check-circle"></i>
                </span>
                <span
                  *ngIf="generatedUserData.isVerified !== 'true'"
                  class="ml-1"
                  title="Unverified"
                >
                  {{ generatedUserData?.username }}
                </span>
              </div>
            </div>
          </div>

          <!-- <hr class="opacity-60" /> -->
          <!-- <ul class="text-sm font-semibold p-2">
            <ng-container *ngIf="!signedIn">
              <li>
                <button
                  (click)="
                    signInWithGoogleCustom();
                    toggleProfileDropdown();
                    $event.preventDefault()
                  "
                  class="flex items-center gap-3 rounded-md p-2 hover:bg-gray-200 dark:hover:bg-gray-700"
                >
                  <i class="fab fa-google text-xl mr-2"></i>
                  <span>Sign in with Google</span>
                </button>
              </li>
            </ng-container> -->
          <!-- Uncomment logout option if needed -->
          <!--
            <ng-template #loggedIn>
              <li>
                <a href="#" (click)="logout(); toggleProfileDropdown(); $event.preventDefault()"
                   class="flex items-center gap-3 rounded-md p-2 hover:bg-gray-200 dark:hover:bg-gray-700">
                  <i class="fa fa-sign-out-alt text-xl mr-2"></i>
                  <span>Log Out</span>
                </a>
              </li>
            </ng-template>
            -->
          <!-- </ul> -->
        </div>
      </div>
    </div>
  </div>
</div>
