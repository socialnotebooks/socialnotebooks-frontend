<!-- Modal Container -->
<div
  *ngIf="isModalOpen"
  class="fixed inset-0 flex items-center justify-center z-50"
>
  <!-- Modal Backdrop -->
  <div class="fixed inset-0 bg-black opacity-50"></div>

  <!-- Modal Content Wrapper -->
  <div class="lg:p-20 relative">
    <div
      class="bg-white dark:bg-dark2 p-7 shadow-xl rounded-lg md:w-[520px] w-full"
    >
      <!-- Modal Header -->
      <div class="text-center py-3 border-b dark:border-slate-700 relative">
        <h2 class="text-sm font-medium">Create Post</h2>
        <button
          type="button"
          class="absolute top-0 right-0"
          (click)="closeModal()"
        >
          <i class="fas fa-times text-4xl text-gray-600"></i>
        </button>
      </div>

      <!-- Modal Body -->
      <div class="space-y-5 mt-7">
        <!-- Caption Input -->
        <div>
          <label class="text-base">What do you have in mind?</label>
          <input
            type="text"
            placeholder="Enter caption..."
            class="w-full mt-3 border border-gray-300 rounded p-2"
            [(ngModel)]="caption"
            (input)="onCaptionChange()"
          />
        </div>

        <!-- File Upload Area -->
        <div>
          <div
            class="w-full h-52 relative border rounded-lg overflow-hidden bg-repeat"
          >
            <label
              for="createStatusUrl"
              class="flex flex-col justify-center items-center w-full h-full absolute -translate-x-1/2 left-1/2 bottom-0 z-10 pb-6 pt-10 cursor-pointer bg-gradient-to-t from-gray-700/60"
            >
              <input
                id="createStatusUrl"
                type="file"
                class="hidden"
                (change)="onFileSelected($event)"
                accept="image/png, image/jpeg, image/jpg, image/gif, image/webp, video/mp4, video/ogg, video/webm"
              />
              <ion-icon name="image" class="text-3xl text-teal-900"></ion-icon>
              <span class="text-white text-xl mt-32"
                >Upload image or video</span
              >
            </label>
            <!-- Media Preview -->
            <ng-container
              *ngIf="selectedFile && selectedFile.type.startsWith('video/')"
            >
              <video
                [src]="imgPreview"
                class="w-full h-full object-cover"
              ></video>
            </ng-container>
            <ng-container
              *ngIf="
                !selectedFile ||
                (selectedFile && !selectedFile.type.startsWith('video/'))
              "
            >
              <img
                *ngIf="imgPreview"
                [src]="imgPreview"
                alt="Uploaded Image"
                class="w-full h-full absolute object-cover"
              />
            </ng-container>
          </div>
        </div>

        <!-- Publish Button and Status Messages -->
        <div class="text-center">
          <button
            type="button"
            (click)="uploadFile()"
            [disabled]="isUploading || !selectedFile"
            [ngClass]="{
              'pointer-events-none opacity-50': isUploading || !selectedFile
            }"
            class="bg-blue-500 text-white px-8 py-2 rounded hover:bg-blue-600 transition-colors"
          >
            Publish Post
          </button>
        </div>
        <div *ngIf="errorMessage" class="text-red-500 text-center">
          {{ errorMessage }}
        </div>
        <div *ngIf="isUploading" class="text-center">
          Uploading... {{ uploadProgress }}%
        </div>
        <div *ngIf="uploadSuccess" class="text-green-500 text-center">
          Feed uploaded successfully!
        </div>
      </div>
    </div>
  </div>
</div>
